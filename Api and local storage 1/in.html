<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
     #display{
        height: 70vh;
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        border: 1px solid red;
        padding: 10px;
    }
    #div2{
        height: 80px;
        margin-top: 50px;
    }
    img{
        width: 65%;
        height: 100%;
        padding: 10px 10px 10px 10px;
    }
    p{
        width: 100%;
        height: 2vh;
        padding: 10px;
    }
</style>
<body>
    <h1>API</h1>
    <div id="display">

    </div>
</body>
</html>
<script>

    const storedData=localStorage.getItem('productdata');
    if(storedData){
        displaydata(JSON.parse(storedData));
    }
    else{

    fetch('https://fakestoreapi.com/products')
    .then(function(res) {
        return res.json();
    })
    .then(function(res) {
        console.log(res);
        localStorage.setItem('productData', JSON.stringify(res));
        displaydata(res);
    })
    .catch((err) => console.log(err));
}


function displaydata(data){
    let div = document.getElementById("display")

    data.forEach((el,i)=>{
        let div2 = document.createElement("div")

        let p= document.createElement("p")
        p.innerText=el.category

        let price=document.createElement("price")
        price.innerText=el.price

        div2.id = "div2"
        let img = document.createElement("img")
        img.src=el.image

        let editButton=document.createElement("button")
        editButton.innerHTML='edit'
        editButton.onclick=()=>editprice(i,el.price);

        let deleteButton=document.createElement("button")
        deleteButton.innerHTML='delete'
        deleteButton.onclick=()=>deleteproduct(i);

        div2.append(img,p,price,editButton,deleteButton)
        div.append(div2)
    });
   }

   function editprice(el,i){
  let x=prompt("edit the price for this product",el.price)
  console.log(x)

  let price=document.getElementById('price-${i}')
  price.innerHTML=x
}

function Delete(index){
    let y = prompt("Do you really want to delete this div? Type 'yes' to confirm.");
    if (y === 'yes') {
        let div2 = document.getElementById(`div2-${index}`); // Use backticks for template literal
        div2?.remove(); // Use optional chaining to safely call remove
    }
}
</script>